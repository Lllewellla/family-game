# Политики: привычки FamilyQuest

## Правки задним числом

- **Разрешено:** создание и удаление логов (complete/uncomplete) за любую дату. API не ограничивает дату.
- **Стрик:** при снятии выполнения (uncomplete) за день стрик пересчитывается по фактическим логам; при добавлении лога за прошлый день стрик увеличивается, если этот день продолжает серию.
- **XP:** при добавлении лога за прошлый день XP начисляется (мягкий режим). При снятии выполнения за день XP не отзывается — уровень пользователя не уменьшается.
- При необходимости ввести «строгий» режим (не начислять XP за закрытые недели/месяцы) это можно добавить в логику `complete_habit` по дате.

## Смена типа привычки

- **Через API:** тип привычки при обновлении (PUT) не передаётся — изменить тип существующей привычки через API нельзя. Это сохраняет согласованность старых логов с форматом value.
- **Рекомендация:** чтобы сменить тип (например, с бинарной на количественную), архивируйте текущую привычку (is_active=false) и создайте новую нужного типа. Старая история остаётся в системе для отчётов.
- Старые записи по привычке не пересчитываются при любых изменениях целей; новые цели применяются с даты `goal_effective_from` (если задана) или сразу.
